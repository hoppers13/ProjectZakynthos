@using ProjectZakynthos.Domain.Philately
@model PhilatelicItem

@{
    var catalogueNumber = $"({new CatalogueAbbreviations()[Model.CatalogueReference.Catalogue]} {Model.CatalogueReference.Number})";
    ViewBag.Title = $"{Model.Year}, {Model.CatalogueReference.Area} {catalogueNumber}";
}

<!-- BID FORM-->
<div id="bid-form" class="modal fade" role="dialog">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal">&times;</button>
                <h4 class="modal-title">[Auction House here]</h4>
            </div>
            <div class="modal-body">
                <div class="row img-circle">
                    <div class="col-md-10 col-lg-offset-1"> <img title="item image here" src="~/Content/Images/394535.jpg" /></div>
                </div>
                <div class="row">
                    <div id="bid-suggestion" class="col-md-10 col-lg-offset-1">
                        <p class="suggestion"> Suggested bid: <b>€350</b><br />(criteria: best chance of winning) </p>
                        <form action="place-bid-with-auction-house">
                            € <input type="text" />
                            <input type="submit" class="btn btn-info btn-lg" value="place bid" />
                        </form>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
            </div>
        </div>
    </div>
</div>


<div id="wish-item">
    <h2>@Model.Year, @Model.CatalogueReference.Area, @Model.Description, @catalogueNumber</h2>
        
    <div class="row">
        <div class="col-md-3">
            <!-- UPCOMING AUCTIONS -->
            <div id="upcoming-auctions">
                <h3> Upcoming Auctions</h3>
                @foreach (var auction in Model.UpcomingAuctions.OrderBy(x => x.AuctionDate))
                {
                    <div class="row">
                        <div class="col-md-4">@auction.AuctionDate.Date.ToShortDateString()</div>
                        <div class="col-md-4">@auction.AuctionHouse</div>
                        <div class="col-md-2">£@auction.StartingBid</div>
                        <div class="col-md-2"><a class="red pointer" data-toggle="modal" data-target="#bid-form">bid</a></div>
                    </div>
                }
            </div>
            
            <!-- CATALOGUE VALUES-->
            <div id="catalogue-values">
                <h3> Catalog Values</h3>
                <table class="table table-striped">
                    <tbody>
                        <tr>
                            <td>Sassone</td>
                            <td>€2000</td>
                        </tr>
                        <tr>
                            <td>Unificato</td>
                            <td>€1750</td>
                        </tr>
                        <tr>
                            <td>Bolaffi</td>
                            <td>€2100</td>
                        </tr>
                    </tbody>                    
                </table>
            </div>
        </div>

        <div class="col-md-1"></div>
                
        <div class="col-md-8">
            <!-- PAST AUCTIONS -->
            <div id="past-auctions">
                <h3>Past Auctions</h3>
                <div>
                    <a data-toggle="collapse" data-target="#past-auctions-tabular" class="pointer">Tabular</a>
                    |
                    <a data-toggle="collapse" data-target="#past-auctions-graph" class="pointer">Graph</a>
                </div>
                <div id="past-auctions-tabular" class="collapse in">
                    <div class="row">
                        <div class="col-md-3">
                            <h4>Auction House</h4>
                        </div>
                        <div class="col-md-3">
                            <h4>Date</h4>
                        </div>
                        <div class="col-md-3">
                            <h4>Starting bid</h4>
                        </div>
                        <div class="col-md-3">
                            <h4>Sold at</h4>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-3">
                            Ghiglione
                        </div>
                        <div class="col-md-3">
                            03/06/2017
                        </div>
                        <div class="col-md-3">
                            €450
                        </div>
                        <div class="col-md-3">
                            not sold
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-3">
                            Ferrario
                        </div>
                        <div class="col-md-3">
                            17/05/2017
                        </div>
                        <div class="col-md-3">
                            €250
                        </div>
                        <div class="col-md-3">
                            €280
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-3">
                            Ghiglione
                        </div>
                        <div class="col-md-3">
                            01/04/2017
                        </div>
                        <div class="col-md-3">
                            €150
                        </div>
                        <div class="col-md-3">
                            €150
                        </div>
                    </div>
                </div>
                <div id="past-auctions-graph" class="collapse">
                    <canvas id="myChart" width="400" height="60"></canvas>
                </div>
            </div>
        </div>
    </div>

</div>

@section scripts{
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.5.0/Chart.bundle.js"></script>
    <script>
        var data = {
            labels: ["Vaccari 01/15", "Ghiglione 11/15", "Gartner 05/16", "Ferrario 04/17"],
            datasets: [
                {
                    label: "Auction results",
                    fill: false,
                    lineTension: 0,
                    backgroundColor: "rgba(75,192,192,0.4)",
                    borderColor: "rgba(75,192,192,1)",
                    borderCapStyle: 'butt',
                    borderDash: [],
                    borderDashOffset: 0.0,
                    borderJoinStyle: 'miter',
                    pointBorderColor: "rgba(75,192,192,1)",
                    pointBackgroundColor: "#fff",
                    pointBorderWidth: 1,
                    pointHoverRadius: 5,
                    pointHoverBackgroundColor: "rgba(75,192,192,1)",
                    pointHoverBorderColor: "rgba(220,220,220,1)",
                    pointHoverBorderWidth: 2,
                    pointRadius: 1,
                    pointHitRadius: 10,
                    data: [300, 150, 250, 280],
                    spanGaps: false,
                }
            ]
        };

        var ctx = document.getElementById("myChart");
        var myChart = new Chart(ctx, {
            type: 'line',
            data: data,
            options: {
                scales: {
                    yAxes: [{
                        ticks: {
                            beginAtZero: false
                        }
                    }]
                }
            }
        });
    </script>
}
